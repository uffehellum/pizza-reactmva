{"version":3,"file":"Selection.Basic.Example.js","sourceRoot":"../src/","sources":["utilities/selection/examples/Selection.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { CommandBar } from 'office-ui-fabric-react/lib/CommandBar';\r\nimport { Check } from 'office-ui-fabric-react/lib/Check';\r\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\r\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\r\nimport { IObjectWithKey, ISelection, Selection, SelectionMode, SelectionZone } from 'office-ui-fabric-react/lib/Selection';\r\nimport { createListItems } from 'office-ui-fabric-react/lib/utilities/exampleData';\r\n\r\nimport './Selection.Example.scss';\r\n\r\nconst ITEM_COUNT = 100;\r\n\r\nexport interface ISelectionBasicExampleState {\r\n  items: any[];\r\n  selection: ISelection;\r\n  selectionMode?: SelectionMode;\r\n  canSelect?: string;\r\n}\r\n\r\nexport interface ISelectionItemExampleProps {\r\n  item?: any;\r\n  itemIndex?: number;\r\n  selection?: ISelection;\r\n  selectionMode?: SelectionMode;\r\n}\r\n\r\n/**\r\n * The SelectionItemExample controls and displays the selection state of a single item\r\n */\r\nexport class SelectionItemExample extends React.Component<ISelectionItemExampleProps, {}> {\r\n  public render(): JSX.Element {\r\n    const { item, itemIndex, selection } = this.props;\r\n    let isSelected = false;\r\n\r\n    if (selection && itemIndex !== undefined) {\r\n      isSelected = selection.isIndexSelected(itemIndex);\r\n    }\r\n\r\n    return (\r\n      <div className=\"ms-SelectionItemExample\" data-is-focusable={true} data-selection-index={itemIndex}>\r\n        {selection &&\r\n          selection.canSelectItem(item) &&\r\n          selection.mode !== SelectionMode.none && (\r\n            <div className=\"ms-SelectionItemExample-check\" data-is-focusable={true} data-selection-toggle={true}>\r\n              <Check checked={isSelected} />\r\n            </div>\r\n          )}\r\n        <span className=\"ms-SelectionItemExample-name\">{item.name}</span>\r\n        <a className=\"ms-SelectionItemExample-link\" href=\"https://bing.com\" target=\"_blank\">\r\n          Link that avoids selection\r\n        </a>\r\n        <a className=\"ms-SelectionItemExample-link\" data-selection-select={true} href=\"https://bing.com\" target=\"_blank\">\r\n          Link that selects first\r\n        </a>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * The SelectionBasicExample controls the selection state of all items\r\n */\r\nexport class SelectionBasicExample extends React.Component<{}, ISelectionBasicExampleState> {\r\n  private _hasMounted: boolean;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._hasMounted = false;\r\n    this._onSelectionChanged = this._onSelectionChanged.bind(this);\r\n    this._onSelectionModeChanged = this._onSelectionModeChanged.bind(this);\r\n    this._onToggleSelectAll = this._onToggleSelectAll.bind(this);\r\n    this._onCanSelectChanged = this._onCanSelectChanged.bind(this);\r\n    this._canSelectItem = this._canSelectItem.bind(this);\r\n\r\n    this.state = {\r\n      items: createListItems(ITEM_COUNT),\r\n      selection: new Selection({ onSelectionChanged: this._onSelectionChanged }),\r\n      selectionMode: SelectionMode.multiple,\r\n      canSelect: 'all'\r\n    };\r\n    this.state.selection.setItems(this.state.items as IObjectWithKey[], false);\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    this._hasMounted = true;\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { items, selection } = this.state;\r\n\r\n    return (\r\n      <div className=\"ms-SelectionBasicExample\">\r\n        <CommandBar items={this._getCommandItems()} />\r\n        <MarqueeSelection selection={selection} isEnabled={selection.mode === SelectionMode.multiple}>\r\n          <SelectionZone\r\n            selection={selection}\r\n            // tslint:disable-next-line:jsx-no-lambda\r\n            onItemInvoked={this._alertItem}\r\n          >\r\n            {items.map((item: { key: string | number }, index: number) => (\r\n              <SelectionItemExample ref={'detailsGroup_' + index} key={item.key} item={item} itemIndex={index} selection={selection} />\r\n            ))}\r\n          </SelectionZone>\r\n        </MarqueeSelection>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _alertItem = (item: { key?: React.Key; name: React.ReactText }): void => alert('item invoked: ' + item.name);\r\n\r\n  private _onSelectionChanged(): void {\r\n    if (this._hasMounted) {\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  private _onToggleSelectAll(): void {\r\n    const { selection } = this.state;\r\n    selection.toggleAllSelected();\r\n  }\r\n\r\n  private _onSelectionModeChanged(ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem): void {\r\n    this.setState((previousState: ISelectionBasicExampleState) => {\r\n      const newSelection = new Selection({\r\n        onSelectionChanged: this._onSelectionChanged,\r\n        canSelectItem: previousState.canSelect === 'vowels' ? this._canSelectItem : undefined,\r\n        selectionMode: menuItem.data\r\n      });\r\n      newSelection.setItems(previousState.items as IObjectWithKey[], false);\r\n\r\n      return {\r\n        selection: newSelection\r\n      };\r\n    });\r\n  }\r\n\r\n  private _onCanSelectChanged(ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem): void {\r\n    const canSelectItem = menuItem.data === 'vowels' ? this._canSelectItem : undefined;\r\n\r\n    this.setState((previousState: ISelectionBasicExampleState) => {\r\n      const newSelection = new Selection({\r\n        onSelectionChanged: this._onSelectionChanged,\r\n        canSelectItem: canSelectItem,\r\n        selectionMode: previousState.selection.mode\r\n      });\r\n      newSelection.setItems(previousState.items as IObjectWithKey[], false);\r\n      return {\r\n        selection: newSelection,\r\n        canSelect: menuItem.data === 'vowels' ? 'vowels' : 'all'\r\n      };\r\n    });\r\n  }\r\n\r\n  private _canSelectItem(item: any): boolean {\r\n    return (\r\n      item.name &&\r\n      (item.name.indexOf('a') === 0 ||\r\n        item.name.indexOf('e') === 0 ||\r\n        item.name.indexOf('i') === 0 ||\r\n        item.name.indexOf('o') === 0 ||\r\n        item.name.indexOf('u') === 0)\r\n    );\r\n  }\r\n\r\n  private _getCommandItems(): IContextualMenuItem[] {\r\n    const { selection, canSelect } = this.state;\r\n\r\n    return [\r\n      {\r\n        key: 'selectionMode',\r\n        text: 'Selection Mode',\r\n        items: [\r\n          {\r\n            key: SelectionMode[SelectionMode.none],\r\n            name: 'None',\r\n            canCheck: true,\r\n            checked: selection.mode === SelectionMode.none,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.none\r\n          },\r\n          {\r\n            key: SelectionMode[SelectionMode.single],\r\n            name: 'Single select',\r\n            canCheck: true,\r\n            checked: selection.mode === SelectionMode.single,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.single\r\n          },\r\n          {\r\n            key: SelectionMode[SelectionMode.multiple],\r\n            name: 'Multi select',\r\n            canCheck: true,\r\n            checked: selection.mode === SelectionMode.multiple,\r\n            onClick: this._onSelectionModeChanged,\r\n            data: SelectionMode.multiple\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        key: 'selectAll',\r\n        text: 'Select All',\r\n        iconProps: { iconName: 'CheckMark' },\r\n        onClick: this._onToggleSelectAll\r\n      },\r\n      {\r\n        key: 'allowCanSelect',\r\n        text: 'Choose selectable items',\r\n        items: [\r\n          {\r\n            key: 'all',\r\n            name: 'All items',\r\n            canCheck: true,\r\n            checked: canSelect === 'all',\r\n            onClick: this._onCanSelectChanged,\r\n            data: 'all'\r\n          },\r\n          {\r\n            key: 'a',\r\n            name: 'Names starting with vowels',\r\n            canCheck: true,\r\n            checked: canSelect === 'vowels',\r\n            onClick: this._onCanSelectChanged,\r\n            data: 'vowels'\r\n          }\r\n        ]\r\n      }\r\n    ];\r\n  }\r\n}\r\n"]}