{"version":3,"file":"DetailsList.DragDrop.Example.js","sourceRoot":"../src/","sources":["components/DetailsList/examples/DetailsList.DragDrop.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { DetailsList, Selection } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\r\nimport { IColumn, buildColumns } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { IDragDropEvents, IDragDropContext } from 'office-ui-fabric-react/lib/utilities/dragdrop/interfaces';\r\nimport './DetailsList.DragDrop.Example.scss';\r\nimport { IColumnReorderOptions } from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { createListItems } from 'office-ui-fabric-react/lib/utilities/exampleData';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\r\n\r\nlet _draggedItem: any = null;\r\nlet _draggedIndex = -1;\r\nlet _items: any[];\r\nlet _columns: IColumn[];\r\nexport class DetailsListDragDropExample extends React.Component<\r\n  {},\r\n  {\r\n    items: {}[];\r\n    selectionDetails?: string;\r\n    columns: IColumn[];\r\n    isColumnReorderEnabled: boolean;\r\n    frozenColumnCountFromStart: string;\r\n    frozenColumnCountFromEnd: string;\r\n  }\r\n> {\r\n  private _selection: Selection;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._onRenderItemColumn = this._onRenderItemColumn.bind(this);\r\n    this._handleColumnReorder = this._handleColumnReorder.bind(this);\r\n    this._getColumnReorderOptions = this._getColumnReorderOptions.bind(this);\r\n    this._onChangeColumnReorderEnabled = this._onChangeColumnReorderEnabled.bind(this);\r\n    this._onChangeStartCountText = this._onChangeStartCountText.bind(this);\r\n    this._onChangeEndCountText = this._onChangeEndCountText.bind(this);\r\n\r\n    this._selection = new Selection();\r\n\r\n    _items = _items || createListItems(10, 0);\r\n    _columns = buildColumns(_items, true);\r\n\r\n    this.state = {\r\n      items: createListItems(10),\r\n      columns: _columns,\r\n      isColumnReorderEnabled: true,\r\n      frozenColumnCountFromStart: '1',\r\n      frozenColumnCountFromEnd: '0'\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { items, selectionDetails, columns, isColumnReorderEnabled, frozenColumnCountFromStart, frozenColumnCountFromEnd } = this.state;\r\n\r\n    return (\r\n      <div className={'detailsListDragDropExample'}>\r\n        <Toggle\r\n          label={'Enable Column Reorder'}\r\n          checked={isColumnReorderEnabled}\r\n          onChange={this._onChangeColumnReorderEnabled}\r\n          onText={'Enabled'}\r\n          offText={'Disabled'}\r\n        />\r\n        <TextField\r\n          label={'Number of Left frozen columns:'}\r\n          onGetErrorMessage={this._validateNumber}\r\n          value={frozenColumnCountFromStart}\r\n          onChange={this._onChangeStartCountText}\r\n        />\r\n        <TextField\r\n          label={'Number of Right frozen columns:'}\r\n          onGetErrorMessage={this._validateNumber}\r\n          value={frozenColumnCountFromEnd}\r\n          onChange={this._onChangeEndCountText}\r\n        />\r\n        <div>{selectionDetails}</div>\r\n        <MarqueeSelection selection={this._selection}>\r\n          <DetailsList\r\n            setKey={'items'}\r\n            items={items}\r\n            columns={columns}\r\n            selection={this._selection}\r\n            selectionPreservedOnEmptyClick={true}\r\n            onItemInvoked={this._onItemInvoked}\r\n            onRenderItemColumn={this._onRenderItemColumn}\r\n            dragDropEvents={this._getDragDropEvents()}\r\n            columnReorderOptions={this.state.isColumnReorderEnabled ? this._getColumnReorderOptions() : undefined}\r\n            ariaLabelForSelectionColumn=\"Toggle selection\"\r\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\r\n          />\r\n        </MarqueeSelection>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _handleColumnReorder = (draggedIndex: number, targetIndex: number) => {\r\n    const draggedItems = this.state.columns[draggedIndex];\r\n    const newColumns: IColumn[] = [...this.state.columns];\r\n\r\n    // insert before the dropped item\r\n    newColumns.splice(draggedIndex, 1);\r\n    newColumns.splice(targetIndex, 0, draggedItems);\r\n    this.setState({ columns: newColumns });\r\n  };\r\n\r\n  private _getColumnReorderOptions(): IColumnReorderOptions {\r\n    return {\r\n      frozenColumnCountFromStart: parseInt(this.state.frozenColumnCountFromStart, 10),\r\n      frozenColumnCountFromEnd: parseInt(this.state.frozenColumnCountFromEnd, 10),\r\n      handleColumnReorder: this._handleColumnReorder\r\n    };\r\n  }\r\n\r\n  private _validateNumber(value: string): string {\r\n    return isNaN(Number(value)) ? `The value should be a number, actual is ${value}.` : '';\r\n  }\r\n\r\n  private _onChangeStartCountText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, text: string): void => {\r\n    this.setState({ frozenColumnCountFromStart: text });\r\n  };\r\n\r\n  private _onChangeEndCountText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, text: string): void => {\r\n    this.setState({ frozenColumnCountFromEnd: text });\r\n  };\r\n\r\n  private _onChangeColumnReorderEnabled = (ev: React.MouseEvent<HTMLElement>, checked: boolean): void => {\r\n    this.setState({ isColumnReorderEnabled: checked });\r\n  };\r\n\r\n  private _getDragDropEvents(): IDragDropEvents {\r\n    return {\r\n      canDrop: (dropContext?: IDragDropContext, dragContext?: IDragDropContext) => {\r\n        return true;\r\n      },\r\n      canDrag: (item?: any) => {\r\n        return true;\r\n      },\r\n      onDragEnter: (item?: any, event?: DragEvent) => {\r\n        return 'dragEnter';\r\n      }, // return string is the css classes that will be added to the entering element.\r\n      onDragLeave: (item?: any, event?: DragEvent) => {\r\n        return;\r\n      },\r\n      onDrop: (item?: any, event?: DragEvent) => {\r\n        if (_draggedItem) {\r\n          this._insertBeforeItem(item);\r\n        }\r\n      },\r\n      onDragStart: (item?: any, itemIndex?: number, selectedItems?: any[], event?: MouseEvent) => {\r\n        _draggedItem = item;\r\n        _draggedIndex = itemIndex!;\r\n      },\r\n      onDragEnd: (item?: any, event?: DragEvent) => {\r\n        _draggedItem = null;\r\n        _draggedIndex = -1;\r\n      }\r\n    };\r\n  }\r\n\r\n  private _onItemInvoked(item: any): void {\r\n    alert(`Item invoked: ${item.name}`);\r\n  }\r\n\r\n  private _onRenderItemColumn(item: any, index: number, column: IColumn): JSX.Element {\r\n    if (column.key === 'name') {\r\n      return <Link data-selection-invoke={true}>{item[column.key]}</Link>;\r\n    }\r\n\r\n    return item[column.key];\r\n  }\r\n\r\n  private _insertBeforeItem(item: any): void {\r\n    const draggedItems = this._selection.isIndexSelected(_draggedIndex) ? this._selection.getSelection() : [_draggedItem];\r\n\r\n    const items: any[] = this.state.items.filter((i: number) => draggedItems.indexOf(i) === -1);\r\n    let insertIndex = items.indexOf(item);\r\n\r\n    // if dragging/dropping on itself, index will be 0.\r\n    if (insertIndex === -1) {\r\n      insertIndex = 0;\r\n    }\r\n\r\n    items.splice(insertIndex, 0, ...draggedItems);\r\n\r\n    this.setState({ items: items });\r\n  }\r\n}\r\n"]}